---
title: "Dissimilarity Temperature & Fishing Regression for All Regions"
output: html_notebook
---

Here we will finally link temperature and fishing to dissimilarity


```{r setup}

library(data.table)
library(ggplot2)
library(lme4)
library(lmerTest)


OISST_data_temp_avgs_full <- readRDS(here::here("data","Temperature","OISST_data_temp_avgs_full.rds"))

#switch year to numeric
OISST_data_temp_avgs_full[, year := as.numeric(as.character(year_for_avg))][, season_survey := as.character(survey_season)][,season := NULL][,survey := NULL]

#pull in average distance decay values
distances_dissimilarities_allyears.year.models <- readRDS(here::here("output","distance_decay","distances_dissimilarities_allyears.year.models.rds"))

#pull in fishing data
SAU_summed_tonnes.r <- readRDS(here::here("data","sea_around_us","SAU_summed_tonnes.rds"))

```

Put into one data table
```{r link temp and fishing to avg values}
#temp
distances_dissimilarities_allyears.year.models.temp <- OISST_data_temp_avgs_full[distances_dissimilarities_allyears.year.models, on = c("year","season_survey")]

#add lowercase survey
SAU_summed_tonnes.r[,survey := Survey]

#fishing
distances_dissimilarities_allyears.year.models.temp.fishing <- SAU_summed_tonnes.r[distances_dissimilarities_allyears.year.models.temp, on = c("year", "survey")]

#save avg values
saveRDS(distances_dissimilarities_allyears.year.models.temp.fishing, here::here("output","distance_decay","distances_dissimilarities_allyears.year.models.temp.fishing.rds"))
```

Plotting with fishing

```{r EBS fishing}

#fishing over time
ebs_fishing <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "EBS_NA",]) +
  geom_point(aes(x = year, y = summed_tonnes), color  = "#3B00FB") +
  labs(x = "Year",  y = "Total Landings (tonnes)") +
  theme_classic()

#for just EBS
ebs_dissimilarity_fishing <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "EBS_NA",]) +
  geom_smooth(aes(x = summed_tonnes, y = mean_yearly_bray), method = "lm", se = F, color  = "#3B00FB") +
  labs(x = "Total Landings (tonnes)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = summed_tonnes, y = mean_yearly_bray), color  = "#3B00FB", alpha = 0.3) +
  theme_classic()

ggsave(ebs_dissimilarity_fishing, path  = here::here("figures","distance_decay"), filename = "ebs_dissimilarity_fishing.jpg") 

ebs_dissimilarity_fishing_mod <- lm(mean_yearly_bray ~ summed_tonnes, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "EBS_NA",])

summary(ebs_dissimilarity_fishing_mod)
```

How does this trend hold up for all regions?
```{r temp all regions}
#for all regions
allreg_dissimilarity_fishing_mean <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing) +
  labs(x = "Scaled Landings (tonnes)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = summed_tonnes_scaled, y = mean_yearly_bray, color = season_survey), alpha = 0.3) +
  geom_line(aes(x = summed_tonnes_scaled, y = mean_yearly_bray, color = season_survey), stat="smooth", method = "lm") +
  scale_color_manual(values =  c("#5A5156","#E4E1E3","#F6222E","#FE00FA", 
  "#16FF32","#3283FE","#FEAF16","#B00068", 
  "#1CFFCE","#90AD1C","#2ED9FF","#DEA0FD", 
  "#AA0DFE","#F8A19F","#325A9B","#C4451C", 
  "#1C8356","#85660D","#B10DA1","#FBE426", 
  "#1CBE4F","#FA0087","#FC1CBF","#F7E1A0", 
  "#C075A6","#782AB6","#AAF400","#BDCDFF", 
  "#822E1C","#B5EFB5","#7ED7D1","#1C7F93", 
  "#D85FF7","#683B79","#66B0FF","#3B00FB")) +
  geom_smooth(aes(x = summed_tonnes_scaled, y = mean_yearly_bray), method = "lm", se = F, color  = "black") +
  theme_classic() +
    theme(legend.position = "none")

ggsave(allreg_dissimilarity_fishing_mean, path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_fishing_mean.jpg", height = 4, width = 9, unit = "in") 

allreg_dissimilarity_fishing_mean_mod <- lmer(mean_yearly_bray ~ summed_tonnes_scaled + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp.fishing)

summary(allreg_dissimilarity_fishing_mean_mod)

library(MuMIn)
r.squaredGLMM(allreg_dissimilarity_fishing_mean_mod)


```

Full mod
```{r}

allreg_dissimilarity_fishing_temp_mod <- lmer(mean_yearly_bray ~ summed_tonnes_scaled*sst_mean_scaled*sst_SD + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp.fishing)

summary(allreg_dissimilarity_fishing_temp_mod)
```
Significant predictors: 
summed_tonnes_scaled_byreg (as landings (proxy for fishing effort) increase, bray dissimilarity decreases)
sst_SD (as the standard deviation of temperature increases, bray dissimilarity increases)
summed_tonnes_scaled_byreg: sst_SD (relationship between sst_SD and dissimilarity depends on landings, relationship between landings and dissimilarity is more positive in regions with 

*IS PART OF THIS BECAUSE I SCALE MEAN AND NOT SD? I'm a little confuse about whether or not I should be doing that?

Let's remove some variables and compare the models
```{r compare mods}
#compare max, min, mean
allreg_dissimilarity_fishing_maxtemp_mod <- lmer(mean_yearly_bray ~ summed_tonnes_scaled*sst_max_scaled*sst_SD + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp.fishing)

allreg_dissimilarity_fishing_mintemp_mod <- lmer(mean_yearly_bray ~ summed_tonnes_scaled*sst_min_scaled*sst_SD + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp.fishing)

#remove mean
allreg_dissimilarity_fishing_temp_mod_SDonly <- lmer(mean_yearly_bray ~ summed_tonnes_scaled*sst_SD + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp.fishing)

summary(allreg_dissimilarity_fishing_temp_mod_SDonly)

#min only, no SD
allreg_dissimilarity_fishing_mintemp_mod_only <- lmer(mean_yearly_bray ~ summed_tonnes_scaled*sst_min_scaled + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp.fishing)

#no interaction
allreg_dissimilarity_fishing_temp_mod_SDonly_nointeraction <- lmer(mean_yearly_bray ~ summed_tonnes_scaled + sst_SD + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp.fishing) #this is clearly the best model, 

AIC(allreg_dissimilarity_fishing_temp_mod,allreg_dissimilarity_fishing_maxtemp_mod, allreg_dissimilarity_fishing_mintemp_mod, allreg_dissimilarity_fishing_temp_mod_SDonly, allreg_dissimilarity_fishing_temp_mod_SDonly_nointeraction, allreg_dissimilarity_fishing_mintemp_mod_only)
```
Mean Dissimilarity = 0.52 - 0.09 * scaled tonnes + 0.06 * sst_SD +  

Plot this model with interaction
```{r}
library(interactions)
sim_slopes(allreg_dissimilarity_fishing_temp_mod_SDonly, pred = sst_SD, modx = summed_tonnes_scaled, johnson_neyman = FALSE)

interact_plot(allreg_dissimilarity_fishing_temp_mod_SDonly, pred = sst_SD, modx = summed_tonnes_scaled, plot.points = T, colors = c("#3283FE","#FEAF16","#B00068")) + theme_classic()

interact_plot(allreg_dissimilarity_fishing_temp_mod_SDonly, pred = sst_SD, modx = summed_tonnes_scaled, linearity.check = TRUE, 
              plot.points = TRUE) #check linearity 

```
Summary: (Doesn't make total sense)
-When fishing is average, higher standard deviation of temperature across a region means higher community dissimilarity 
-When fishing is high, higher standard deviation of temperature across a region means even higher community dissimilarity
-When fishing is low, higher standard deviation of temperature across a region means lower community dissimilarity



Zoom in on North Sea
```{r North Sea}

```





What about scaled for all regions?

```{r temp all regions but scaled}
#for all regions
allreg_dissimilarity_temperature_mean_scaled <- ggplot(data = distances_dissimilarities_allyears.year.models.temp) +
  labs(x = "Mean Annual SST Scaled",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean_scaled, y = mean_yearly_bray, color = season_survey), alpha = 0.3) +
  geom_line(aes(x = sst_mean_scaled, y = mean_yearly_bray, color = season_survey), stat="smooth", method = "lm") +
  scale_color_manual(values =  c("#5A5156","#E4E1E3","#F6222E","#FE00FA", 
  "#16FF32","#3283FE","#FEAF16","#B00068", 
  "#1CFFCE","#90AD1C","#2ED9FF","#DEA0FD", 
  "#AA0DFE","#F8A19F","#325A9B","#C4451C", 
  "#1C8356","#85660D","#B10DA1","#FBE426", 
  "#1CBE4F","#FA0087","#FC1CBF","#F7E1A0", 
  "#C075A6","#782AB6","#AAF400","#BDCDFF", 
  "#822E1C","#B5EFB5","#7ED7D1","#1C7F93", 
  "#D85FF7","#683B79","#66B0FF","#3B00FB")) +
  geom_smooth(aes(x = sst_mean_scaled, y = mean_yearly_bray), method = "lm", se = F, color  = "black") +
  theme_classic()

ggsave(allreg_dissimilarity_temperature_mean_scaled, path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_mean_scaled.jpg", height = 4, width = 9, unit = "in")

#no legend
ggsave(allreg_dissimilarity_temperature_mean_scaled + theme(legend.position = "none"), path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_mean_scaled_nolegend.jpg", height = 4, width = 9, unit = "in") 

allreg_dissimilarity_temperature_mean_scaled_mod <- lmer(mean_yearly_bray ~ sst_mean_scaled + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp)

summary(allreg_dissimilarity_temperature_mean_scaled_mod)

#minimum all regions
allreg_dissimilarity_temperature_min_scaled <- ggplot(data = distances_dissimilarities_allyears.year.models.temp) +
  labs(x = "Minimum Annual SST Scaled",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_min_scaled, y = mean_yearly_bray, color = season_survey), alpha = 0.3) +
  geom_line(aes(x = sst_min_scaled, y = mean_yearly_bray, color = season_survey), stat="smooth", method = "lm") +
  scale_color_manual(values =  c("#5A5156","#E4E1E3","#F6222E","#FE00FA", 
  "#16FF32","#3283FE","#FEAF16","#B00068", 
  "#1CFFCE","#90AD1C","#2ED9FF","#DEA0FD", 
  "#AA0DFE","#F8A19F","#325A9B","#C4451C", 
  "#1C8356","#85660D","#B10DA1","#FBE426", 
  "#1CBE4F","#FA0087","#FC1CBF","#F7E1A0", 
  "#C075A6","#782AB6","#AAF400","#BDCDFF", 
  "#822E1C","#B5EFB5","#7ED7D1","#1C7F93", 
  "#D85FF7","#683B79","#66B0FF","#3B00FB")) +
  geom_smooth(aes(x = sst_min_scaled, y = mean_yearly_bray), method = "lm", se = F, color  = "black") +
  theme_classic()

ggsave(allreg_dissimilarity_temperature_min_scaled, path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_min_scaled.jpg", height = 4, width = 9, unit = "in") 

#no legend
ggsave(allreg_dissimilarity_temperature_min_scaled + theme(legend.position = "none"), path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_min_scaled_nolegend.jpg", height = 4, width = 9, unit = "in") 

allreg_dissimilarity_temperature_min_scaled_mod <- lmer(mean_yearly_bray ~ sst_min_scaled + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp)

summary(allreg_dissimilarity_temperature_min_scaled_mod)

#maximum for all regions
allreg_dissimilarity_temperature_max_scaled <- ggplot(data = distances_dissimilarities_allyears.year.models.temp) +
  labs(x = "Maximum Annual SST Scaled",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_max_scaled, y = mean_yearly_bray, color = season_survey), alpha = 0.3) +
  geom_line(aes(x = sst_max_scaled, y = mean_yearly_bray, color = season_survey), stat="smooth", method = "lm") +
  scale_color_manual(values =  c("#5A5156","#E4E1E3","#F6222E","#FE00FA", 
  "#16FF32","#3283FE","#FEAF16","#B00068", 
  "#1CFFCE","#90AD1C","#2ED9FF","#DEA0FD", 
  "#AA0DFE","#F8A19F","#325A9B","#C4451C", 
  "#1C8356","#85660D","#B10DA1","#FBE426", 
  "#1CBE4F","#FA0087","#FC1CBF","#F7E1A0", 
  "#C075A6","#782AB6","#AAF400","#BDCDFF", 
  "#822E1C","#B5EFB5","#7ED7D1","#1C7F93", 
  "#D85FF7","#683B79","#66B0FF","#3B00FB")) +
  geom_smooth(aes(x = sst_max_scaled, y = mean_yearly_bray), method = "lm", se = F, color  = "black") +
  theme_classic()

ggsave(allreg_dissimilarity_temperature_max_scaled, path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_max_scaled.jpg", height = 4, width = 9, unit = "in") 

#no legend
ggsave(allreg_dissimilarity_temperature_max_scaled + theme(legend.position = "none"), path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_max_scaled_nolegend.jpg", height = 4, width = 9, unit = "in") 

allreg_dissimilarity_temperature_max_scaled_mod <- lmer(mean_yearly_bray ~ sst_max_scaled + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp)

summary(allreg_dissimilarity_temperature_max_scaled_mod)

#SD all reg (not sure this makes sense scaled?)
allreg_dissimilarity_temperature_SD_scaled <- ggplot(data = distances_dissimilarities_allyears.year.models.temp) +
  labs(x = "SD of Annual SST Scaled",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_SD_scaled, y = mean_yearly_bray, color = season_survey), alpha = 0.3) +
  geom_line(aes(x = sst_SD_scaled, y = mean_yearly_bray, color = season_survey), stat="smooth", method = "lm") +
  scale_color_manual(values =  c("#5A5156","#E4E1E3","#F6222E","#FE00FA", 
  "#16FF32","#3283FE","#FEAF16","#B00068", 
  "#1CFFCE","#90AD1C","#2ED9FF","#DEA0FD", 
  "#AA0DFE","#F8A19F","#325A9B","#C4451C", 
  "#1C8356","#85660D","#B10DA1","#FBE426", 
  "#1CBE4F","#FA0087","#FC1CBF","#F7E1A0", 
  "#C075A6","#782AB6","#AAF400","#BDCDFF", 
  "#822E1C","#B5EFB5","#7ED7D1","#1C7F93", 
  "#D85FF7","#683B79","#66B0FF","#3B00FB")) +
  geom_smooth(aes(x = sst_SD_scaled, y = mean_yearly_bray), method = "lm", se = F, color  = "black") +
  theme_classic()

ggsave(allreg_dissimilarity_temperature_SD_scaled, path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_SD_scaled.jpg", height = 4, width = 9, unit = "in") 

#no legend
ggsave(allreg_dissimilarity_temperature_SD_scaled + theme(legend.position = "none"), path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_SD_scaled_nolegend.jpg", height = 4, width = 9, unit = "in") 

allreg_dissimilarity_temperature_SD_scaled_mod <- lmer(mean_yearly_bray ~ sst_SD_scaled + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp)

summary(allreg_dissimilarity_temperature_SD_scaled_mod)
```

Zoomed in examples:
* No change in dissimilarity w temp gulf of mexico fall 
* Decrease in dissimilarity w temp in EBS
* Increase in dissimilarity w temp in GSL-S (this could easily be because sampling changes over time)
* Instead, I'll use NorthSea as example

GMEX FALL example
```{r zoom in on example regions gmex fall}

#for just Gulf of mexico fall 
GMEX_Fall_dissimilarity_temperature_mean <- ggplot(data = distances_dissimilarities_allyears.year.models.temp[season_survey == "GMEX_Fall",]) +
  labs(x = "Mean Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean, y = mean_yearly_bray), color = "#7ED7D1", alpha = 0.8) +
  geom_line(aes(x = sst_mean, y = mean_yearly_bray), color = "#7ED7D1", stat="smooth", method = "lm") +
  theme_classic()

ggsave(GMEX_Fall_dissimilarity_temperature_mean, path  = here::here("figures","distance_decay"), filename = "GMEX_Fall_dissimilarity_temperature_mean.jpg", height = 3, width = 4, unit = "in") 

GMEX_Fall_dissimilarity_temperature_mean_mod <- lm(mean_yearly_bray ~ sst_mean, data = distances_dissimilarities_allyears.year.models.temp[season_survey == "GMEX_Fall",])

summary(GMEX_Fall_dissimilarity_temperature_mean_mod)
```

EBS

```{r zoom in on example regions ebs}

#for just ebs
EBS_dissimilarity_temperature_mean <- ggplot(data = distances_dissimilarities_allyears.year.models.temp[season_survey == "EBS_NA",]) +
  labs(x = "Mean Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean, y = mean_yearly_bray), color = "#3283FE", alpha = 0.8) +
  geom_line(aes(x = sst_mean, y = mean_yearly_bray), color = "#3283FE", stat="smooth", method = "lm") +
  theme_classic()

ggsave(EBS_dissimilarity_temperature_mean, path  = here::here("figures","distance_decay"), filename = "EBS_dissimilarity_temperature_mean.jpg", height = 3, width = 4, unit = "in") 

EBS_dissimilarity_temperature_mean_mod <- lm(mean_yearly_bray ~ sst_mean, data = distances_dissimilarities_allyears.year.models.temp[season_survey == "EBS_NA",])

summary(EBS_dissimilarity_temperature_mean_mod)
```

EBS

```{r zoom in on example regions ebs againn}

#for just ebs
EBS_dissimilarity_temperature_mean <- ggplot(data = distances_dissimilarities_allyears.year.models.temp[season_survey == "EBS_NA",]) +
  labs(x = "Mean Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean, y = mean_yearly_bray), color = "#3283FE", alpha = 0.8) +
  geom_line(aes(x = sst_mean, y = mean_yearly_bray), color = "#3283FE", stat="smooth", method = "lm") +
  theme_classic()

ggsave(EBS_dissimilarity_temperature_mean, path  = here::here("figures","distance_decay"), filename = "EBS_dissimilarity_temperature_mean.jpg", height = 3, width = 4, unit = "in") 

EBS_dissimilarity_temperature_mean_mod <- lm(mean_yearly_bray ~ sst_mean, data = distances_dissimilarities_allyears.year.models.temp[season_survey == "EBS_NA",])

summary(EBS_dissimilarity_temperature_mean_mod)
```

Full EBS to match below NS and SCS
```{r zoom in on example regions EBS}
#Independent trends over time

#dissimilarity over time
EBS_dissimilarity_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "EBS_NA",]) +
  labs(x = "Year",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = year, y = mean_yearly_bray), color = "#3283FE") +
  geom_line(aes(x = year, y = mean_yearly_bray), color = "#3283FE", stat="smooth", method = "lm") +
  theme_classic()

#meantemp over time
EBS_mean_temp_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "EBS_NA",]) +
  labs(x = "Year",  y = "Mean Annual SST (˚C)") +
  geom_point(aes(x = year, y = sst_mean), color = "#3283FE") +
  geom_line(aes(x = year, y = sst_mean), color = "#3283FE", stat="smooth", method = "lm") +
  theme_classic()

#SD temp over time
EBS_SD_temp_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "EBS_NA",]) +
  labs(x = "Year",  y = "SD of Mean Annual SST (˚C)") +
  geom_point(aes(x = year, y = sst_SD), color = "#3283FE") +
  geom_line(aes(x = year, y = sst_SD), color = "#3283FE", stat="smooth", method = "lm") +
  theme_classic()

#fishing over time
EBS_fishing_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "EBS_NA",]) +
  labs(x = "Year",  y = "Landings (tonnes)") +
  geom_point(aes(x = year, y = summed_tonnes), color = "#3283FE") +
  geom_line(aes(x = year, y = summed_tonnes), color = "#3283FE", stat="smooth", method = "lm") +
  theme_classic()

EBS_characteristics <- plot_grid(EBS_dissimilarity_time, EBS_mean_temp_time, EBS_SD_temp_time, EBS_fishing_time, ncol = 4, align = "hv")

ggsave(EBS_characteristics, path  = here::here("figures","distance_decay"), filename = "EBS_characteristics_merge.jpg", height = 2.5, width = 9, unit = "in") 

#plotting linear models
#for just ebs mean temp
EBS_dissimilarity_temperature_mean <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "EBS_NA",]) +
  labs(x = "Mean Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean, y = mean_yearly_bray), color = "#3283FE") +
  geom_line(aes(x = sst_mean, y = mean_yearly_bray), color = "#3283FE", stat="smooth", method = "lm") +
  theme_classic()

EBS_dissimilarity_temperature_mean

ggsave(EBS_dissimilarity_temperature_mean, path  = here::here("figures","distance_decay"), filename = "EBS_dissimilarity_temperature_mean.jpg", height = 3, width = 4, unit = "in") 

EBS_dissimilarity_temperature_mean_mod <- lm(mean_yearly_bray ~ sst_mean_scaled, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "EBS_NA",])

summary(EBS_dissimilarity_temperature_mean_mod)

#for just ebs SD
EBS_dissimilarity_temperature_SD <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "EBS_NA",]) +
  labs(x = "SD of Mean Temperature",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_SD, y = mean_yearly_bray), color = "#3283FE") +
  geom_line(aes(x = sst_SD, y = mean_yearly_bray), color = "#3283FE", stat="smooth", method = "lm") +
  theme_classic()

EBS_dissimilarity_temperature_SD

ggsave(EBS_dissimilarity_temperature_SD, path  = here::here("figures","distance_decay"), filename = "EBS_dissimilarity_temperature_SD.jpg", height = 3, width = 4, unit = "in") 

EBS_dissimilarity_temperature_SD_mod <- lm(mean_yearly_bray ~ sst_SD, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "EBS_NA",])

summary(EBS_dissimilarity_temperature_SD_mod)

#for just ebs fishing
#for just ebs SD
EBS_dissimilarity_fishing <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "EBS_NA",]) +
  labs(x = "Summed Landings (tonnes)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = summed_tonnes, y = mean_yearly_bray), color = "#3283FE") +
  geom_line(aes(x = summed_tonnes, y = mean_yearly_bray), color = "#3283FE", stat="smooth", method = "lm") +
  theme_classic()

EBS_dissimilarity_fishing

ggsave(EBS_dissimilarity_fishing, path  = here::here("figures","distance_decay"), filename = "EBS_dissimilarity_temperature_SD.jpg", height = 3, width = 4, unit = "in") 

EBS_dissimilarity_fishing_mod <- lm(mean_yearly_bray ~ summed_tonnes, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "EBS_NA",])

summary(EBS_dissimilarity_fishing_mod)

EBS <- plot_grid(EBS_dissimilarity_temperature_mean, EBS_dissimilarity_temperature_SD + theme(axis.title.y = element_blank()), EBS_dissimilarity_fishing +theme(axis.title.y = element_blank()), ncol = 3, align = "hv")

ggsave(EBS, path  = here::here("figures","distance_decay"), filename = "EBS_merge.jpg", height = 3, width = 9, unit = "in") 
```


North Sea

```{r zoom in on example regions northsea}
#Independent trends over time

#dissimilarity over time
NS_IBTS_dissimilarity_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "NS-IBTS_NA",]) +
  labs(x = "Year",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = year, y = mean_yearly_bray), color = "#F7E1A0") +
  geom_line(aes(x = year, y = mean_yearly_bray), color = "#F7E1A0", stat="smooth", method = "lm") +
  theme_classic()

#meantemp over time
NS_IBTS_mean_temp_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "NS-IBTS_NA",]) +
  labs(x = "Year",  y = "Mean Annual SST (˚C)") +
  geom_point(aes(x = year, y = sst_mean), color = "#F7E1A0") +
  geom_line(aes(x = year, y = sst_mean), color = "#F7E1A0", stat="smooth", method = "lm") +
  theme_classic()

#SD temp over time
NS_IBTS_SD_temp_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "NS-IBTS_NA",]) +
  labs(x = "Year",  y = "SD of Mean Annual SST (˚C)") +
  geom_point(aes(x = year, y = sst_SD), color = "#F7E1A0") +
  geom_line(aes(x = year, y = sst_SD), color = "#F7E1A0", stat="smooth", method = "lm") +
  theme_classic()

#fishing over time
NS_IBTS_fishing_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "NS-IBTS_NA",]) +
  labs(x = "Year",  y = "Landings (tonnes)") +
  geom_point(aes(x = year, y = summed_tonnes), color = "#F7E1A0") +
  geom_line(aes(x = year, y = summed_tonnes), color = "#F7E1A0", stat="smooth", method = "lm") +
  theme_classic()

ns_ibts_characteristics <- plot_grid(NS_IBTS_dissimilarity_time, NS_IBTS_mean_temp_time, NS_IBTS_SD_temp_time, NS_IBTS_fishing_time, ncol = 4, align = "hv")

ggsave(ns_ibts_characteristics, path  = here::here("figures","distance_decay"), filename = "NS_ibts_characteristics_merge.jpg", height = 2.5, width = 9, unit = "in") 

#plotting linear models
#for just ebs mean temp
NS_IBTS_dissimilarity_temperature_mean <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "NS-IBTS_NA",]) +
  labs(x = "Mean Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean, y = mean_yearly_bray), color = "#F7E1A0") +
  geom_line(aes(x = sst_mean, y = mean_yearly_bray), color = "#F7E1A0", stat="smooth", method = "lm") +
  theme_classic()

NS_IBTS_dissimilarity_temperature_mean

ggsave(NS_IBTS_dissimilarity_temperature_mean, path  = here::here("figures","distance_decay"), filename = "NS_IBTS_dissimilarity_temperature_mean.jpg", height = 3, width = 4, unit = "in") 

NS_IBTS_dissimilarity_temperature_mean_mod <- lm(mean_yearly_bray ~ sst_mean_scaled, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "NS-IBTS_NA",])

summary(NS_IBTS_dissimilarity_temperature_mean_mod)

#for just ebs SD
NS_IBTS_dissimilarity_temperature_SD <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "NS-IBTS_NA",]) +
  labs(x = "SD of Mean Temperature",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_SD, y = mean_yearly_bray), color = "#F7E1A0") +
  geom_line(aes(x = sst_SD, y = mean_yearly_bray), color = "#F7E1A0", stat="smooth", method = "lm") +
  theme_classic()

NS_IBTS_dissimilarity_temperature_SD

ggsave(NS_IBTS_dissimilarity_temperature_SD, path  = here::here("figures","distance_decay"), filename = "NS_IBTS_dissimilarity_temperature_SD.jpg", height = 3, width = 4, unit = "in") 

NS_IBTS_dissimilarity_temperature_SD_mod <- lm(mean_yearly_bray ~ sst_SD, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "NS-IBTS_NA",])

summary(NS_IBTS_dissimilarity_temperature_SD_mod)

#for just ebs fishing
#for just ebs SD
NS_IBTS_dissimilarity_fishing <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "NS-IBTS_NA",]) +
  labs(x = "Summed Landings (tonnes)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = summed_tonnes, y = mean_yearly_bray), color = "#F7E1A0") +
  geom_line(aes(x = summed_tonnes, y = mean_yearly_bray), color = "#F7E1A0", stat="smooth", method = "lm") +
  theme_classic()

NS_IBTS_dissimilarity_fishing

ggsave(NS_IBTS_dissimilarity_fishing, path  = here::here("figures","distance_decay"), filename = "NS_IBTS_dissimilarity_temperature_SD.jpg", height = 3, width = 4, unit = "in") 

NS_IBTS_dissimilarity_fishing_mod <- lm(mean_yearly_bray ~ summed_tonnes, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "NS-IBTS_NA",])

summary(NS_IBTS_dissimilarity_fishing_mod)

ns_ibts <- plot_grid(NS_IBTS_dissimilarity_temperature_mean, NS_IBTS_dissimilarity_temperature_SD + theme(axis.title.y = element_blank()), NS_IBTS_dissimilarity_fishing +theme(axis.title.y = element_blank()), ncol = 3, align = "hv")

ggsave(ns_ibts, path  = here::here("figures","distance_decay"), filename = "NS_ibts_merge.jpg", height = 3, width = 9, unit = "in") 
```

Scotian Shelf

```{r zoom in on example regions scotian shelf}

#Independent trends over time

#dissimilarity over time
SCS_SUMMER_dissimilarity_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "SCS_SUMMER",]) +
  labs(x = "Year",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = year, y = mean_yearly_bray), color = "#822E1C") +
  geom_line(aes(x = year, y = mean_yearly_bray), color = "#822E1C", stat="smooth", method = "lm") +
  theme_classic()

#meantemp over time
SCS_SUMMER_mean_temp_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "SCS_SUMMER",]) +
  labs(x = "Year",  y = "Mean Annual SST (˚C)") +
  geom_point(aes(x = year, y = sst_mean), color = "#822E1C") +
  geom_line(aes(x = year, y = sst_mean), color = "#822E1C", stat="smooth", method = "lm") +
  theme_classic()

#SD temp over time
SCS_SUMMER_SD_temp_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "SCS_SUMMER",]) +
  labs(x = "Year",  y = "SD of Mean Annual SST (˚C)") +
  geom_point(aes(x = year, y = sst_SD), color = "#822E1C") +
  geom_line(aes(x = year, y = sst_SD), color = "#822E1C", stat="smooth", method = "lm") +
  theme_classic()

#fishing over time
SCS_SUMMER_fishing_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "SCS_SUMMER",]) +
  labs(x = "Year",  y = "Landings (tonnes)") +
  geom_point(aes(x = year, y = summed_tonnes), color = "#822E1C") +
  geom_line(aes(x = year, y = summed_tonnes), color = "#822E1C", stat="smooth", method = "lm") +
  theme_classic()

SCS_SUMMER_characteristics <- plot_grid(SCS_SUMMER_dissimilarity_time, SCS_SUMMER_mean_temp_time, SCS_SUMMER_SD_temp_time, SCS_SUMMER_fishing_time, ncol = 4, align = "hv")

ggsave(SCS_SUMMER_characteristics, path  = here::here("figures","distance_decay"), filename = "SCS_SUMMER_characteristics_merge.jpg", height = 2.5, width = 9, unit = "in") 

#plotting linear models

#for just scs mean temp
SCS_SUMMER_dissimilarity_temperature_mean <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "SCS_SUMMER",]) +
  labs(x = "Mean Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean, y = mean_yearly_bray), color = "#822E1C") +
  geom_line(aes(x = sst_mean, y = mean_yearly_bray), color = "#822E1C", stat="smooth", method = "lm") +
  theme_classic()

SCS_SUMMER_dissimilarity_temperature_mean

ggsave(SCS_SUMMER_dissimilarity_temperature_mean, path  = here::here("figures","distance_decay"), filename = "SCS_SUMMER_dissimilarity_temperature_mean.jpg", height = 3, width = 4, unit = "in") 

SCS_SUMMER_dissimilarity_temperature_mean_mod <- lm(mean_yearly_bray ~ sst_mean_scaled, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "SCS_SUMMER",])

summary(SCS_SUMMER_dissimilarity_temperature_mean_mod)

#for just ebs SD
SCS_SUMMER_dissimilarity_temperature_SD <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "SCS_SUMMER",]) +
  labs(x = "SD of Mean Temperature",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_SD, y = mean_yearly_bray), color = "#822E1C") +
  geom_line(aes(x = sst_SD, y = mean_yearly_bray), color = "#822E1C", stat="smooth", method = "lm") +
  theme_classic()

SCS_SUMMER_dissimilarity_temperature_SD

ggsave(SCS_SUMMER_dissimilarity_temperature_SD, path  = here::here("figures","distance_decay"), filename = "SCS_SUMMER_dissimilarity_temperature_SD.jpg", height = 3, width = 4, unit = "in") 

SCS_SUMMER_dissimilarity_temperature_SD_mod <- lm(mean_yearly_bray ~ sst_SD, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "SCS_SUMMER",])

summary(SCS_SUMMER_dissimilarity_temperature_SD_mod)

#for just ebs fishing
#for just ebs SD
SCS_SUMMER_dissimilarity_fishing <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "SCS_SUMMER",]) +
  labs(x = "Summed Landings (tonnes)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = summed_tonnes, y = mean_yearly_bray), color = "#822E1C") +
  geom_line(aes(x = summed_tonnes, y = mean_yearly_bray), color = "#822E1C", stat="smooth", method = "lm") +
  theme_classic()

SCS_SUMMER_dissimilarity_fishing

ggsave(SCS_SUMMER_dissimilarity_fishing, path  = here::here("figures","distance_decay"), filename = "SCS_SUMMER_dissimilarity_temperature_SD.jpg", height = 3, width = 4, unit = "in") 

SCS_SUMMER_dissimilarity_fishing_mod <- lm(mean_yearly_bray ~ summed_tonnes, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "SCS_SUMMER",])

summary(SCS_SUMMER_dissimilarity_fishing_mod)

library(cowplot)
scs_merge <- plot_grid(SCS_SUMMER_dissimilarity_temperature_mean, SCS_SUMMER_dissimilarity_temperature_SD + theme(axis.title.y = element_blank()), SCS_SUMMER_dissimilarity_fishing +theme(axis.title.y = element_blank()), ncol = 3, align = "hv")

ggsave(scs_merge, path  = here::here("figures","distance_decay"), filename = "scs_merge.jpg", height = 3, width = 9, unit = "in") 
```

Irish Sea: IE-IGFS_NA Irish Sea

```{r zoom in on example regions irish sea}

#Independent trends over time

#dissimilarity over time
IE_IGFS_NA_dissimilarity_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "IE-IGFS_NA",]) +
  labs(x = "Year",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = year, y = mean_yearly_bray), color = "#C4451C") +
  geom_line(aes(x = year, y = mean_yearly_bray), color = "#C4451C", stat="smooth", method = "lm") +
  theme_classic()

#meantemp over time
IE_IGFS_NA_mean_temp_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "IE-IGFS_NA",]) +
  labs(x = "Year",  y = "Mean Annual SST (˚C)") +
  geom_point(aes(x = year, y = sst_mean), color = "#C4451C") +
  geom_line(aes(x = year, y = sst_mean), color = "#C4451C", stat="smooth", method = "lm") +
  theme_classic()

#SD temp over time
IE_IGFS_NA_SD_temp_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "IE-IGFS_NA",]) +
  labs(x = "Year",  y = "SD of Mean Annual SST (˚C)") +
  geom_point(aes(x = year, y = sst_SD), color = "#C4451C") +
  geom_line(aes(x = year, y = sst_SD), color = "#C4451C", stat="smooth", method = "lm") +
  theme_classic()

#fishing over time
IE_IGFS_NA_fishing_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "IE-IGFS_NA",]) +
  labs(x = "Year",  y = "Landings (tonnes)") +
  geom_point(aes(x = year, y = summed_tonnes), color = "#C4451C") +
  geom_line(aes(x = year, y = summed_tonnes), color = "#C4451C", stat="smooth", method = "lm") +
  theme_classic()

IE_IGFS_NA_characteristics <- plot_grid(IE_IGFS_NA_dissimilarity_time, IE_IGFS_NA_mean_temp_time, IE_IGFS_NA_SD_temp_time, IE_IGFS_NA_fishing_time, ncol = 4, align = "hv")

ggsave(IE_IGFS_NA_characteristics, path  = here::here("figures","distance_decay"), filename = "IE_IGFS_NA_characteristics_merge.jpg", height = 2.5, width = 9, unit = "in") 

#plotting linear models

#for just scs mean temp
IE_IGFS_NA_dissimilarity_temperature_mean <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "IE-IGFS_NA",]) +
  labs(x = "Mean Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean, y = mean_yearly_bray), color = "#C4451C") +
  geom_line(aes(x = sst_mean, y = mean_yearly_bray), color = "#C4451C", stat="smooth", method = "lm") +
  theme_classic()

IE_IGFS_NA_dissimilarity_temperature_mean

ggsave(IE_IGFS_NA_dissimilarity_temperature_mean, path  = here::here("figures","distance_decay"), filename = "IE_IGFS_NA_dissimilarity_temperature_mean.jpg", height = 3, width = 4, unit = "in") 

IE_IGFS_NA_dissimilarity_temperature_mean_mod <- lm(mean_yearly_bray ~ sst_mean_scaled, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "IE-IGFS_NA",])

summary(IE_IGFS_NA_dissimilarity_temperature_mean_mod)

#for just ebs SD
IE_IGFS_NA_dissimilarity_temperature_SD <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "IE-IGFS_NA",]) +
  labs(x = "SD of Mean Temperature",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_SD, y = mean_yearly_bray), color = "#C4451C") +
  geom_line(aes(x = sst_SD, y = mean_yearly_bray), color = "#C4451C", stat="smooth", method = "lm") +
  theme_classic()

IE_IGFS_NA_dissimilarity_temperature_SD

ggsave(IE_IGFS_NA_dissimilarity_temperature_SD, path  = here::here("figures","distance_decay"), filename = "IE_IGFS_NA_dissimilarity_temperature_SD.jpg", height = 3, width = 4, unit = "in") 

IE_IGFS_NA_dissimilarity_temperature_SD_mod <- lm(mean_yearly_bray ~ sst_SD, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "IE-IGFS_NA",])

summary(IE_IGFS_NA_dissimilarity_temperature_SD_mod)

#for just ebs fishing
#for just ebs SD
IE_IGFS_NA_dissimilarity_fishing <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "IE-IGFS_NA",]) +
  labs(x = "Summed Landings (tonnes)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = summed_tonnes, y = mean_yearly_bray), color = "#C4451C") +
  geom_line(aes(x = summed_tonnes, y = mean_yearly_bray), color = "#C4451C", stat="smooth", method = "lm") +
  theme_classic()

IE_IGFS_NA_dissimilarity_fishing

ggsave(IE_IGFS_NA_dissimilarity_fishing, path  = here::here("figures","distance_decay"), filename = "IE_IGFS_NA_dissimilarity_temperature_SD.jpg", height = 3, width = 4, unit = "in") 

IE_IGFS_NA_dissimilarity_fishing_mod <- lm(mean_yearly_bray ~ summed_tonnes, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "IE-IGFS_NA",])

summary(IE_IGFS_NA_dissimilarity_fishing_mod)

library(cowplot)
IE_IFGS_merge <- plot_grid(IE_IGFS_NA_dissimilarity_temperature_mean, IE_IGFS_NA_dissimilarity_temperature_SD + theme(axis.title.y = element_blank()), IE_IGFS_NA_dissimilarity_fishing +theme(axis.title.y = element_blank()), ncol = 3, align = "hv")

ggsave(IE_IFGS_merge, path  = here::here("figures","distance_decay"), filename = "IE_IFGS_merge.jpg", height = 3, width = 9, unit = "in") 
```

Gulf of Mexico

```{r zoom in on example regions gmex fall }

#Independent trends over time

#dissimilarity over time
GMEX_Fall_dissimilarity_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "GMEX_Fall",]) +
  labs(x = "Year",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = year, y = mean_yearly_bray), color = "#7ED7D1") +
  geom_line(aes(x = year, y = mean_yearly_bray), color = "#7ED7D1", stat="smooth", method = "lm") +
  theme_classic()

#meantemp over time
GMEX_Fall_mean_temp_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "GMEX_Fall",]) +
  labs(x = "Year",  y = "Mean Annual SST (˚C)") +
  geom_point(aes(x = year, y = sst_mean), color = "#7ED7D1") +
  geom_line(aes(x = year, y = sst_mean), color = "#7ED7D1", stat="smooth", method = "lm") +
  theme_classic()

#SD temp over time
GMEX_Fall_SD_temp_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "GMEX_Fall",]) +
  labs(x = "Year",  y = "SD of Mean Annual SST (˚C)") +
  geom_point(aes(x = year, y = sst_SD), color = "#7ED7D1") +
  geom_line(aes(x = year, y = sst_SD), color = "#7ED7D1", stat="smooth", method = "lm") +
  theme_classic()

#fishing over time
GMEX_Fall_fishing_time <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "GMEX_Fall",]) +
  labs(x = "Year",  y = "Landings (tonnes)") +
  geom_point(aes(x = year, y = summed_tonnes), color = "#7ED7D1") +
  geom_line(aes(x = year, y = summed_tonnes), color = "#7ED7D1", stat="smooth", method = "lm") +
  theme_classic()

GMEX_Fall_characteristics <- plot_grid(GMEX_Fall_dissimilarity_time, GMEX_Fall_mean_temp_time, GMEX_Fall_SD_temp_time, GMEX_Fall_fishing_time, ncol = 4, align = "hv")

ggsave(GMEX_Fall_characteristics, path  = here::here("figures","distance_decay"), filename = "GMEX_Fall_characteristics_merge.jpg", height = 2.5, width = 9, unit = "in") 

#plotting linear models

#for just scs mean temp
GMEX_Fall_dissimilarity_temperature_mean <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "GMEX_Fall",]) +
  labs(x = "Mean Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean, y = mean_yearly_bray), color = "#7ED7D1") +
  geom_line(aes(x = sst_mean, y = mean_yearly_bray), color = "#7ED7D1", stat="smooth", method = "lm") +
  theme_classic()

GMEX_Fall_dissimilarity_temperature_mean

ggsave(GMEX_Fall_dissimilarity_temperature_mean, path  = here::here("figures","distance_decay"), filename = "GMEX_Fall_dissimilarity_temperature_mean.jpg", height = 3, width = 4, unit = "in") 

GMEX_Fall_dissimilarity_temperature_mean_mod <- lm(mean_yearly_bray ~ sst_mean_scaled, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "GMEX_Fall",])

summary(GMEX_Fall_dissimilarity_temperature_mean_mod)

#for just ebs SD
GMEX_Fall_dissimilarity_temperature_SD <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "GMEX_Fall",]) +
  labs(x = "SD of Mean Temperature",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_SD, y = mean_yearly_bray), color = "#7ED7D1") +
  geom_line(aes(x = sst_SD, y = mean_yearly_bray), color = "#7ED7D1", stat="smooth", method = "lm") +
  theme_classic()

GMEX_Fall_dissimilarity_temperature_SD

ggsave(GMEX_Fall_dissimilarity_temperature_SD, path  = here::here("figures","distance_decay"), filename = "GMEX_Fall_dissimilarity_temperature_SD.jpg", height = 3, width = 4, unit = "in") 

GMEX_Fall_dissimilarity_temperature_SD_mod <- lm(mean_yearly_bray ~ sst_SD, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "GMEX_Fall",])

summary(GMEX_Fall_dissimilarity_temperature_SD_mod)

#for just ebs fishing
#for just ebs SD
GMEX_Fall_dissimilarity_fishing <- ggplot(data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "GMEX_Fall",]) +
  labs(x = "Summed Landings (tonnes)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = summed_tonnes, y = mean_yearly_bray), color = "#7ED7D1") +
  geom_line(aes(x = summed_tonnes, y = mean_yearly_bray), color = "#7ED7D1", stat="smooth", method = "lm") +
  theme_classic()

GMEX_Fall_dissimilarity_fishing

ggsave(GMEX_Fall_dissimilarity_fishing, path  = here::here("figures","distance_decay"), filename = "GMEX_Fall_dissimilarity_temperature_SD.jpg", height = 3, width = 4, unit = "in") 

GMEX_Fall_dissimilarity_fishing_mod <- lm(mean_yearly_bray ~ summed_tonnes, data = distances_dissimilarities_allyears.year.models.temp.fishing[season_survey == "GMEX_Fall",])

summary(GMEX_Fall_dissimilarity_fishing_mod)

library(cowplot)
GMEX_Fall_merge <- plot_grid(GMEX_Fall_dissimilarity_temperature_mean, GMEX_Fall_dissimilarity_temperature_SD + theme(axis.title.y = element_blank()), GMEX_Fall_dissimilarity_fishing +theme(axis.title.y = element_blank()), ncol = 3, align = "hv")

ggsave(GMEX_Fall_merge, path  = here::here("figures","distance_decay"), filename = "GMEX_Fall_merge.jpg", height = 3, width = 9, unit = "in") 
```
