---
title: "Dissimilarity Temperature Regression for All Regions"
output: html_notebook
---

Here we will finally link temperature to dissimilarity

NEXT STEP: Instead of absolute temperature, look at temperature anomolies 

```{r setup}

library(data.table)
library(ggplot2)
library(lme4)
library(lmerTest)


OISST_data_temp_avgs_full <- readRDS(here::here("data","Temperature","OISST_data_temp_avgs_full.rds"))

#switch year to numeric
OISST_data_temp_avgs_full[, year:= as.numeric(as.character(year_for_avg))][, season_survey := as.character(survey_season)][,season := NULL][,survey := NULL]

#pull in average distance decay values
distances_dissimilarities_allyears.year.models <- readRDS(here::here("output","distance_decay","distances_dissimilarities_allyears.year.models.rds"))

```

Put into one data table
```{r link temp to avg values}
distances_dissimilarities_allyears.year.models.temp <- OISST_data_temp_avgs_full[distances_dissimilarities_allyears.year.models, on = c("year","season_survey")]
```

How does mean temp and SD temp vary across regions?
```{r mean temp versus SD temp}
(allreg_temperature_mean_v_SD <- ggplot(data = distances_dissimilarities_allyears.year.models.temp) +
  labs(x = "Mean of Annual SST Scaled (˚C)",  y = "SD of Annual SST (˚C)") +
  geom_point(aes(x = sst_mean_scaled, y = sst_SD, color = season_survey), alpha = 0.3) +
  geom_line(aes(x = sst_mean_scaled, y = sst_SD, color = season_survey), stat="smooth", method = "lm") +
  scale_color_manual(values =  c("#5A5156","#E4E1E3","#F6222E","#FE00FA", 
  "#16FF32","#3283FE","#FEAF16","#B00068", 
  "#1CFFCE","#90AD1C","#2ED9FF","#DEA0FD", 
  "#AA0DFE","#F8A19F","#325A9B","#C4451C", 
  "#1C8356","#85660D","#B10DA1","#FBE426", 
  "#1CBE4F","#FA0087","#FC1CBF","#F7E1A0", 
  "#C075A6","#782AB6","#AAF400","#BDCDFF", 
  "#822E1C","#B5EFB5","#7ED7D1","#1C7F93", 
  "#D85FF7","#683B79","#66B0FF","#3B00FB")) +
  geom_smooth(aes(x = sst_mean_scaled, y = sst_SD), method = "lm", se = F, color  = "black") +
  theme_classic())

ggsave(allreg_temperature_mean_v_SD, path  = here::here("figures","distance_decay"), filename = "allreg_temperature_mean_v_SD.jpg", height = 4, width = 9, unit = "in") 

allreg_temperature_mean_SD_mod <- lmer(sst_SD ~ sst_mean_scaled + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp)

summary(allreg_temperature_mean_SD_mod)
```


Plotting with temp

```{r EBS temp}

#for just EBS
ebs_dissimilarity_temperature_mean <- ggplot(data = distances_dissimilarities_allyears.year.models.temp[season_survey == "EBS_NA",]) +
  geom_smooth(aes(x = sst_mean, y = mean_yearly_bray), method = "lm", se = F, color  = "#3B00FB") +
  labs(x = "Mean Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean, y = mean_yearly_bray), color  = "#3B00FB", alpha = 0.3) +
  theme_classic()

ggsave(ebs_dissimilarity_temperature_mean, path  = here::here("figures","distance_decay"), filename = "ebs_dissimilarity_temperature_mean.jpg") 

ebs_dissimilarity_temperature_mean_mod <- lm(mean_yearly_bray ~ sst_mean, data = distances_dissimilarities_allyears.year.models.temp[season_survey == "EBS_NA",])

summary(ebs_dissimilarity_temperature_mean_mod)

#for just EBS
ebs_dissimilarity_temperature_max <- ggplot(data = distances_dissimilarities_allyears.year.models.temp[season_survey == "EBS_NA",]) +
  geom_smooth(aes(x = sst_max, y = mean_yearly_bray), method = "lm", se = F, color  = "#C4451C") +
  labs(x = "Maximum Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_max, y = mean_yearly_bray), color  = "#C4451C", alpha = 0.3) +
  theme_classic()

ggsave(ebs_dissimilarity_temperature_max, path  = here::here("figures","distance_decay"), filename = "ebs_dissimilarity_temperature_max.jpg") 

#for just EBS
ebs_dissimilarity_temperature_min <- ggplot(data = distances_dissimilarities_allyears.year.models.temp[season_survey == "EBS_NA",]) +
  geom_smooth(aes(x = sst_min, y = mean_yearly_bray), method = "lm", se = F, color  ="#325A9B") +
  labs(x = "Minimum Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_min, y = mean_yearly_bray), color  ="#325A9B", alpha = 0.3) +
  theme_classic()

ggsave(ebs_dissimilarity_temperature_min, path  = here::here("figures","distance_decay"), filename = "ebs_dissimilarity_temperature_min.jpg") 

#for just EBS
ebs_dissimilarity_temperature_SD <- ggplot(data = distances_dissimilarities_allyears.year.models.temp[season_survey == "EBS_NA",]) +
  geom_smooth(aes(x = sst_SD, y = mean_yearly_bray), method = "gam", se = F, color  ="#C075A6") +
  labs(x = "Standard Deviation SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_SD, y = mean_yearly_bray), color  = "#C075A6", alpha = 0.3) +
  theme_classic()

ggsave(ebs_dissimilarity_temperature_SD, path  = here::here("figures","distance_decay"), filename = "ebs_dissimilarity_temperature_SD.jpg") 
```

How does this trend hold up for all regions?
```{r temp all regions}
#for all regions
allreg_dissimilarity_temperature_mean <- ggplot(data = distances_dissimilarities_allyears.year.models.temp) +
  labs(x = "Mean Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean, y = mean_yearly_bray, color = season_survey), alpha = 0.3) +
  geom_line(aes(x = sst_mean, y = mean_yearly_bray, color = season_survey), stat="smooth", method = "lm") +
  scale_color_manual(values =  c("#5A5156","#E4E1E3","#F6222E","#FE00FA", 
  "#16FF32","#3283FE","#FEAF16","#B00068", 
  "#1CFFCE","#90AD1C","#2ED9FF","#DEA0FD", 
  "#AA0DFE","#F8A19F","#325A9B","#C4451C", 
  "#1C8356","#85660D","#B10DA1","#FBE426", 
  "#1CBE4F","#FA0087","#FC1CBF","#F7E1A0", 
  "#C075A6","#782AB6","#AAF400","#BDCDFF", 
  "#822E1C","#B5EFB5","#7ED7D1","#1C7F93", 
  "#D85FF7","#683B79","#66B0FF","#3B00FB")) +
  geom_smooth(aes(x = sst_mean, y = mean_yearly_bray), method = "lm", se = F, color  = "black") +
  theme_classic()

ggsave(allreg_dissimilarity_temperature_mean, path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_mean.jpg", height = 4, width = 9, unit = "in") 

allreg_dissimilarity_temperature_mean_mod <- lmer(mean_yearly_bray ~ sst_mean + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp)

summary(allreg_dissimilarity_temperature_mean_mod)

#minimum all regions
allreg_dissimilarity_temperature_min <- ggplot(data = distances_dissimilarities_allyears.year.models.temp) +
  labs(x = "Minimum Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_min, y = mean_yearly_bray, color = season_survey), alpha = 0.3) +
  geom_line(aes(x = sst_min, y = mean_yearly_bray, color = season_survey), stat="smooth", method = "lm") +
  scale_color_manual(values =  c("#5A5156","#E4E1E3","#F6222E","#FE00FA", 
  "#16FF32","#3283FE","#FEAF16","#B00068", 
  "#1CFFCE","#90AD1C","#2ED9FF","#DEA0FD", 
  "#AA0DFE","#F8A19F","#325A9B","#C4451C", 
  "#1C8356","#85660D","#B10DA1","#FBE426", 
  "#1CBE4F","#FA0087","#FC1CBF","#F7E1A0", 
  "#C075A6","#782AB6","#AAF400","#BDCDFF", 
  "#822E1C","#B5EFB5","#7ED7D1","#1C7F93", 
  "#D85FF7","#683B79","#66B0FF","#3B00FB")) +
  geom_smooth(aes(x = sst_min, y = mean_yearly_bray), method = "lm", se = F, color  = "black") +
  theme_classic()

ggsave(allreg_dissimilarity_temperature_min, path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_min.jpg", height = 4, width = 9, unit = "in") 

allreg_dissimilarity_temperature_min_mod <- lmer(mean_yearly_bray ~ sst_min + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp)

summary(allreg_dissimilarity_temperature_min_mod)

#maximum for all regions
allreg_dissimilarity_temperature_max <- ggplot(data = distances_dissimilarities_allyears.year.models.temp) +
  labs(x = "Maximum Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_max, y = mean_yearly_bray, color = season_survey), alpha = 0.3) +
  geom_line(aes(x = sst_max, y = mean_yearly_bray, color = season_survey), stat="smooth", method = "lm") +
  scale_color_manual(values =  c("#5A5156","#E4E1E3","#F6222E","#FE00FA", 
  "#16FF32","#3283FE","#FEAF16","#B00068", 
  "#1CFFCE","#90AD1C","#2ED9FF","#DEA0FD", 
  "#AA0DFE","#F8A19F","#325A9B","#C4451C", 
  "#1C8356","#85660D","#B10DA1","#FBE426", 
  "#1CBE4F","#FA0087","#FC1CBF","#F7E1A0", 
  "#C075A6","#782AB6","#AAF400","#BDCDFF", 
  "#822E1C","#B5EFB5","#7ED7D1","#1C7F93", 
  "#D85FF7","#683B79","#66B0FF","#3B00FB")) +
  geom_smooth(aes(x = sst_max, y = mean_yearly_bray), method = "lm", se = F, color  = "black") +
  theme_classic()

ggsave(allreg_dissimilarity_temperature_max, path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_max.jpg", height = 4, width = 9, unit = "in") 

allreg_dissimilarity_temperature_max_mod <- lmer(mean_yearly_bray ~ sst_max + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp)

summary(allreg_dissimilarity_temperature_max_mod)

#SD all reg
allreg_dissimilarity_temperature_SD <- ggplot(data = distances_dissimilarities_allyears.year.models.temp) +
  labs(x = "SD of Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_SD, y = mean_yearly_bray, color = season_survey), alpha = 0.3) +
  geom_line(aes(x = sst_SD, y = mean_yearly_bray, color = season_survey), stat="smooth", method = "lm") +
  scale_color_manual(values =  c("#5A5156","#E4E1E3","#F6222E","#FE00FA", 
  "#16FF32","#3283FE","#FEAF16","#B00068", 
  "#1CFFCE","#90AD1C","#2ED9FF","#DEA0FD", 
  "#AA0DFE","#F8A19F","#325A9B","#C4451C", 
  "#1C8356","#85660D","#B10DA1","#FBE426", 
  "#1CBE4F","#FA0087","#FC1CBF","#F7E1A0", 
  "#C075A6","#782AB6","#AAF400","#BDCDFF", 
  "#822E1C","#B5EFB5","#7ED7D1","#1C7F93", 
  "#D85FF7","#683B79","#66B0FF","#3B00FB")) +
  geom_smooth(aes(x = sst_SD, y = mean_yearly_bray), method = "lm", se = F, color  = "black") +
  theme_classic()

ggsave(allreg_dissimilarity_temperature_SD, path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_SD.jpg", height = 4, width = 9, unit = "in") 

allreg_dissimilarity_temperature_SD_mod <- lmer(mean_yearly_bray ~ sst_SD + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp)

summary(allreg_dissimilarity_temperature_SD_mod)
```

What about scaled for all regions?

```{r temp all regions but scaled}
#for all regions
allreg_dissimilarity_temperature_mean_scaled <- ggplot(data = distances_dissimilarities_allyears.year.models.temp) +
  labs(x = "Mean Annual SST Scaled",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean_scaled, y = mean_yearly_bray, color = season_survey), alpha = 0.3) +
  geom_line(aes(x = sst_mean_scaled, y = mean_yearly_bray, color = season_survey), stat="smooth", method = "lm") +
  scale_color_manual(values =  c("#5A5156","#E4E1E3","#F6222E","#FE00FA", 
  "#16FF32","#3283FE","#FEAF16","#B00068", 
  "#1CFFCE","#90AD1C","#2ED9FF","#DEA0FD", 
  "#AA0DFE","#F8A19F","#325A9B","#C4451C", 
  "#1C8356","#85660D","#B10DA1","#FBE426", 
  "#1CBE4F","#FA0087","#FC1CBF","#F7E1A0", 
  "#C075A6","#782AB6","#AAF400","#BDCDFF", 
  "#822E1C","#B5EFB5","#7ED7D1","#1C7F93", 
  "#D85FF7","#683B79","#66B0FF","#3B00FB")) +
  geom_smooth(aes(x = sst_mean_scaled, y = mean_yearly_bray), method = "lm", se = F, color  = "black") +
  theme_classic()

ggsave(allreg_dissimilarity_temperature_mean_scaled, path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_mean_scaled.jpg", height = 4, width = 9, unit = "in")

#no legend
ggsave(allreg_dissimilarity_temperature_mean_scaled + theme(legend.position = "none"), path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_mean_scaled_nolegend.jpg", height = 4, width = 9, unit = "in") 

allreg_dissimilarity_temperature_mean_scaled_mod <- lmer(mean_yearly_bray ~ sst_mean_scaled + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp)

summary(allreg_dissimilarity_temperature_mean_scaled_mod)

#minimum all regions
allreg_dissimilarity_temperature_min_scaled <- ggplot(data = distances_dissimilarities_allyears.year.models.temp) +
  labs(x = "Minimum Annual SST Scaled",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_min_scaled, y = mean_yearly_bray, color = season_survey), alpha = 0.3) +
  geom_line(aes(x = sst_min_scaled, y = mean_yearly_bray, color = season_survey), stat="smooth", method = "lm") +
  scale_color_manual(values =  c("#5A5156","#E4E1E3","#F6222E","#FE00FA", 
  "#16FF32","#3283FE","#FEAF16","#B00068", 
  "#1CFFCE","#90AD1C","#2ED9FF","#DEA0FD", 
  "#AA0DFE","#F8A19F","#325A9B","#C4451C", 
  "#1C8356","#85660D","#B10DA1","#FBE426", 
  "#1CBE4F","#FA0087","#FC1CBF","#F7E1A0", 
  "#C075A6","#782AB6","#AAF400","#BDCDFF", 
  "#822E1C","#B5EFB5","#7ED7D1","#1C7F93", 
  "#D85FF7","#683B79","#66B0FF","#3B00FB")) +
  geom_smooth(aes(x = sst_min_scaled, y = mean_yearly_bray), method = "lm", se = F, color  = "black") +
  theme_classic()

ggsave(allreg_dissimilarity_temperature_min_scaled, path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_min_scaled.jpg", height = 4, width = 9, unit = "in") 

#no legend
ggsave(allreg_dissimilarity_temperature_min_scaled + theme(legend.position = "none"), path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_min_scaled_nolegend.jpg", height = 4, width = 9, unit = "in") 

allreg_dissimilarity_temperature_min_scaled_mod <- lmer(mean_yearly_bray ~ sst_min_scaled + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp)

summary(allreg_dissimilarity_temperature_min_scaled_mod)

#maximum for all regions
allreg_dissimilarity_temperature_max_scaled <- ggplot(data = distances_dissimilarities_allyears.year.models.temp) +
  labs(x = "Maximum Annual SST Scaled",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_max_scaled, y = mean_yearly_bray, color = season_survey), alpha = 0.3) +
  geom_line(aes(x = sst_max_scaled, y = mean_yearly_bray, color = season_survey), stat="smooth", method = "lm") +
  scale_color_manual(values =  c("#5A5156","#E4E1E3","#F6222E","#FE00FA", 
  "#16FF32","#3283FE","#FEAF16","#B00068", 
  "#1CFFCE","#90AD1C","#2ED9FF","#DEA0FD", 
  "#AA0DFE","#F8A19F","#325A9B","#C4451C", 
  "#1C8356","#85660D","#B10DA1","#FBE426", 
  "#1CBE4F","#FA0087","#FC1CBF","#F7E1A0", 
  "#C075A6","#782AB6","#AAF400","#BDCDFF", 
  "#822E1C","#B5EFB5","#7ED7D1","#1C7F93", 
  "#D85FF7","#683B79","#66B0FF","#3B00FB")) +
  geom_smooth(aes(x = sst_max_scaled, y = mean_yearly_bray), method = "lm", se = F, color  = "black") +
  theme_classic()

ggsave(allreg_dissimilarity_temperature_max_scaled, path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_max_scaled.jpg", height = 4, width = 9, unit = "in") 

#no legend
ggsave(allreg_dissimilarity_temperature_max_scaled + theme(legend.position = "none"), path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_max_scaled_nolegend.jpg", height = 4, width = 9, unit = "in") 

allreg_dissimilarity_temperature_max_scaled_mod <- lmer(mean_yearly_bray ~ sst_max_scaled + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp)

summary(allreg_dissimilarity_temperature_max_scaled_mod)

#SD all reg (not sure this makes sense scaled?)
allreg_dissimilarity_temperature_SD_scaled <- ggplot(data = distances_dissimilarities_allyears.year.models.temp) +
  labs(x = "SD of Annual SST Scaled",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_SD_scaled, y = mean_yearly_bray, color = season_survey), alpha = 0.3) +
  geom_line(aes(x = sst_SD_scaled, y = mean_yearly_bray, color = season_survey), stat="smooth", method = "lm") +
  scale_color_manual(values =  c("#5A5156","#E4E1E3","#F6222E","#FE00FA", 
  "#16FF32","#3283FE","#FEAF16","#B00068", 
  "#1CFFCE","#90AD1C","#2ED9FF","#DEA0FD", 
  "#AA0DFE","#F8A19F","#325A9B","#C4451C", 
  "#1C8356","#85660D","#B10DA1","#FBE426", 
  "#1CBE4F","#FA0087","#FC1CBF","#F7E1A0", 
  "#C075A6","#782AB6","#AAF400","#BDCDFF", 
  "#822E1C","#B5EFB5","#7ED7D1","#1C7F93", 
  "#D85FF7","#683B79","#66B0FF","#3B00FB")) +
  geom_smooth(aes(x = sst_SD_scaled, y = mean_yearly_bray), method = "lm", se = F, color  = "black") +
  theme_classic()

ggsave(allreg_dissimilarity_temperature_SD_scaled, path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_SD_scaled.jpg", height = 4, width = 9, unit = "in") 

#no legend
ggsave(allreg_dissimilarity_temperature_SD_scaled + theme(legend.position = "none"), path  = here::here("figures","distance_decay"), filename = "allreg_dissimilarity_temperature_SD_scaled_nolegend.jpg", height = 4, width = 9, unit = "in") 

allreg_dissimilarity_temperature_SD_scaled_mod <- lmer(mean_yearly_bray ~ sst_SD_scaled + (1|season_survey), data = distances_dissimilarities_allyears.year.models.temp)

summary(allreg_dissimilarity_temperature_SD_scaled_mod)
```

Zoomed in examples:
* No change in dissimilarity w temp gulf of mexico fall 
* Decrease in dissimilarity w temp in EBS
* Increase in dissimilarity w temp in GSL-S (this could easily be because sampling changes over time)
* Instead, I'll use NorthSea as example

GMEX FALL example
```{r zoom in on example regions gmex fall}

#for just Gulf of mexico fall 
GMEX_FALL_dissimilarity_temperature_mean <- ggplot(data = distances_dissimilarities_allyears.year.models.temp[season_survey == "GMEX_Fall",]) +
  labs(x = "Mean Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean, y = mean_yearly_bray), color = "#7ED7D1", alpha = 0.8) +
  geom_line(aes(x = sst_mean, y = mean_yearly_bray), color = "#7ED7D1", stat="smooth", method = "lm") +
  theme_classic()

ggsave(GMEX_FALL_dissimilarity_temperature_mean, path  = here::here("figures","distance_decay"), filename = "GMEX_FALL_dissimilarity_temperature_mean.jpg", height = 3, width = 4, unit = "in") 

GMEX_FALL_dissimilarity_temperature_mean_mod <- lm(mean_yearly_bray ~ sst_mean, data = distances_dissimilarities_allyears.year.models.temp[season_survey == "GMEX_Fall",])

summary(GMEX_FALL_dissimilarity_temperature_mean_mod)
```

EBS

```{r zoom in on example regions ebs}

#for just ebs
EBS_dissimilarity_temperature_mean <- ggplot(data = distances_dissimilarities_allyears.year.models.temp[season_survey == "EBS_NA",]) +
  labs(x = "Mean Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean, y = mean_yearly_bray), color = "#3283FE", alpha = 0.8) +
  geom_line(aes(x = sst_mean, y = mean_yearly_bray), color = "#3283FE", stat="smooth", method = "lm") +
  theme_classic()

ggsave(EBS_dissimilarity_temperature_mean, path  = here::here("figures","distance_decay"), filename = "EBS_dissimilarity_temperature_mean.jpg", height = 3, width = 4, unit = "in") 

EBS_dissimilarity_temperature_mean_mod <- lm(mean_yearly_bray ~ sst_mean, data = distances_dissimilarities_allyears.year.models.temp[season_survey == "EBS_NA",])

summary(EBS_dissimilarity_temperature_mean_mod)
```

EBS

```{r zoom in on example regions ebs againn}

#for just ebs
EBS_dissimilarity_temperature_mean <- ggplot(data = distances_dissimilarities_allyears.year.models.temp[season_survey == "EBS_NA",]) +
  labs(x = "Mean Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean, y = mean_yearly_bray), color = "#3283FE", alpha = 0.8) +
  geom_line(aes(x = sst_mean, y = mean_yearly_bray), color = "#3283FE", stat="smooth", method = "lm") +
  theme_classic()

ggsave(EBS_dissimilarity_temperature_mean, path  = here::here("figures","distance_decay"), filename = "EBS_dissimilarity_temperature_mean.jpg", height = 3, width = 4, unit = "in") 

EBS_dissimilarity_temperature_mean_mod <- lm(mean_yearly_bray ~ sst_mean, data = distances_dissimilarities_allyears.year.models.temp[season_survey == "EBS_NA",])

summary(EBS_dissimilarity_temperature_mean_mod)
```

North Sea

```{r zoom in on example regions northsea}

#for just ebs
NS_IBTS_dissimilarity_temperature_mean <- ggplot(data = distances_dissimilarities_allyears.year.models.temp[season_survey == "NS-IBTS_NA",]) +
  labs(x = "Mean Annual SST (˚C)",  y = "Average Bray Curtis Dissimilarity") +
  geom_point(aes(x = sst_mean, y = mean_yearly_bray), color = "#F7E1A0") +
  geom_line(aes(x = sst_mean, y = mean_yearly_bray), color = "#F7E1A0", stat="smooth", method = "lm") +
  theme_classic()

ggsave(NS_IBTS_dissimilarity_temperature_mean, path  = here::here("figures","distance_decay"), filename = "NS_IBTS_dissimilarity_temperature_mean.jpg", height = 3, width = 4, unit = "in") 

NS_IBTS_dissimilarity_temperature_mean_mod <- lm(mean_yearly_bray ~ sst_mean, data = distances_dissimilarities_allyears.year.models.temp[season_survey == "NS-IBTS_NA",])

summary(NS_IBTS_dissimilarity_temperature_mean_mod)
```